(this["webpackJsonpsales-tracker"]=this["webpackJsonpsales-tracker"]||[]).push([[54],{1339:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(3),r=a(25),c=a(128),o=a.n(c),s=a(125),i=a(322),u=a(1238),l=a(39),d=a(1357),p=a(0),h=["links","activeLast"];function b(e){var t=e.links,a=e.activeLast,c=void 0!==a&&a,o=Object(r.a)(e,h),u=t[t.length-1].name,l=t.map((function(e){return Object(p.jsx)(j,{link:e},e.name)})),b=t.map((function(e){return Object(p.jsx)("div",{children:e.name!==u?Object(p.jsx)(j,{link:e}):Object(p.jsx)(i.a,{variant:"body2",sx:{maxWidth:260,overflow:"hidden",whiteSpace:"nowrap",color:"text.disabled",textOverflow:"ellipsis"},children:u})},e.name)}));return Object(p.jsx)(d.a,Object(n.a)(Object(n.a)({separator:Object(p.jsx)(s.a,{component:"span",sx:{width:4,height:4,borderRadius:"50%",bgcolor:"text.disabled"}})},o),{},{children:c?l:b}))}function j(e){var t=e.link,a=t.href,n=t.name,r=t.icon;return Object(p.jsxs)(u.a,{variant:"body2",component:l.b,to:a||"#",sx:{lineHeight:2,display:"flex",alignItems:"center",color:"text.primary","& > div":{display:"inherit"}},children:[r&&Object(p.jsx)(s.a,{sx:{mr:1,"& svg":{width:20,height:20}},children:r}),n]},n)}var f=["links","action","heading","moreLink","sx"];function m(e){var t=e.links,a=e.action,c=e.heading,l=e.moreLink,d=void 0===l?[]:l,h=e.sx,j=Object(r.a)(e,f);return Object(p.jsxs)(s.a,{sx:Object(n.a)({mb:5},h),children:[Object(p.jsxs)(s.a,{sx:{display:"flex",alignItems:"center"},children:[Object(p.jsxs)(s.a,{sx:{flexGrow:1},children:[Object(p.jsx)(i.a,{variant:"h4",gutterBottom:!0,children:c}),Object(p.jsx)(b,Object(n.a)({links:t},j))]}),a&&Object(p.jsx)(s.a,{sx:{flexShrink:0},children:a})]}),Object(p.jsx)(s.a,{sx:{mt:2},children:o()(d)?Object(p.jsx)(u.a,{href:d,target:"_blank",rel:"noopener",variant:"body2",children:d}):d.map((function(e){return Object(p.jsx)(u.a,{noWrap:!0,href:e,variant:"body2",target:"_blank",rel:"noopener",sx:{display:"table"},children:e},e)}))})]})}},1429:function(e,t,a){"use strict";a.d(t,"b",(function(){return v})),a.d(t,"a",(function(){return g})),a.d(t,"c",(function(){return k})),a.d(t,"d",(function(){return S}));var n=a(29),r=a(3),c=a(21),o=a(17),s=a.n(o),i=a(96),u=a(435),l=a.n(u),d=a(442),p=a.n(d),h=a(100),b=a.n(h),j=a(23),f=a(22),m=Object(i.b)({name:"purchase",initialState:{isLoading:!1,error:null,purchases:[],purchase:null,sortBy:null,filters:{gender:[],category:"All",colors:[],priceRange:"",rating:""},checkout:{activeStep:0,cart:[],subtotal:0,total:0,discount:0,shipping:0,billing:null}},reducers:{startLoading:function(e){e.isLoading=!0},hasError:function(e,t){e.isLoading=!1,e.error=t.payload},getpurchasesSuccess:function(e,t){e.isLoading=!1,e.purchases=t.payload},getpurchaseSuccess:function(e,t){e.isLoading=!1,e.purchase=t.payload},sortBypurchases:function(e,t){e.sortBy=t.payload},filterpurchases:function(e,t){e.filters.gender=t.payload.gender,e.filters.category=t.payload.category,e.filters.colors=t.payload.colors,e.filters.priceRange=t.payload.priceRange,e.filters.rating=t.payload.rating},getCart:function(e,t){var a=t.payload,n=l()(a.map((function(e){return e.price*e.quantity}))),r=0===a.length?0:e.checkout.discount,c=0===a.length?0:e.checkout.shipping,o=0===a.length?null:e.checkout.billing;e.checkout.cart=a,e.checkout.discount=r,e.checkout.shipping=c,e.checkout.billing=o,e.checkout.subtotal=n,e.checkout.total=n-r},addCart:function(e,t){var a=t.payload,n=0===e.checkout.cart.length;e.checkout.cart=n?[].concat(Object(c.a)(e.checkout.cart),[a]):e.checkout.cart.map((function(e){return e.id===a.id?Object(r.a)(Object(r.a)({},e),{},{quantity:e.quantity+1}):e})),e.checkout.cart=p()([].concat(Object(c.a)(e.checkout.cart),[a]),"id")},deleteCart:function(e,t){var a=e.checkout.cart.filter((function(e){return e.id!==t.payload}));e.checkout.cart=a},resetCart:function(e){e.checkout.activeStep=0,e.checkout.cart=[],e.checkout.total=0,e.checkout.subtotal=0,e.checkout.discount=0,e.checkout.shipping=0,e.checkout.billing=null},onBackStep:function(e){e.checkout.activeStep-=1},onNextStep:function(e){e.checkout.activeStep+=1},onGotoStep:function(e,t){var a=t.payload;e.checkout.activeStep=a},increaseQuantity:function(e,t){var a=t.payload,n=e.checkout.cart.map((function(e){return e.id===a?Object(r.a)(Object(r.a)({},e),{},{quantity:e.quantity+1}):e}));e.checkout.cart=n},decreaseQuantity:function(e,t){var a=t.payload,n=e.checkout.cart.map((function(e){return e.id===a?Object(r.a)(Object(r.a)({},e),{},{quantity:e.quantity-1}):e}));e.checkout.cart=n},createBilling:function(e,t){e.checkout.billing=t.payload},applyDiscount:function(e,t){var a=t.payload;e.checkout.discount=a,e.checkout.total=e.checkout.subtotal-a},applyShipping:function(e,t){var a=t.payload;e.checkout.shipping=a,e.checkout.total=e.checkout.subtotal-e.checkout.discount+a}}}),x=(m.reducer,m.actions);x.getCart,x.addCart,x.resetCart,x.onGotoStep,x.onBackStep,x.onNextStep,x.deleteCart,x.createBilling,x.applyShipping,x.applyDiscount,x.increaseQuantity,x.decreaseQuantity,x.sortBypurchases,x.filterpurchases;function v(e,t,a,n,r){return O.apply(this,arguments)}function O(){return(O=Object(n.a)(s.a.mark((function e(t,a,n,r,c){var o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("".concat(f.b,"purchase/list"),{skip:t,limit:a,search:n,from:r,to:c});case 3:return o=e.sent,e.abrupt("return",o.data.response);case 7:e.prev=7,e.t0=e.catch(0),Object(j.a)(m.actions.hasError(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function g(){return y.apply(this,arguments)}function y(){return(y=Object(n.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("".concat(f.b,"dealers/getdealersList"),{});case 3:return t=e.sent,e.abrupt("return",t.data.response);case 7:e.prev=7,e.t0=e.catch(0),Object(j.a)(m.actions.hasError(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function k(e){return w.apply(this,arguments)}function w(){return(w=Object(n.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("".concat(f.b,"purchase/Details"),{_id:t});case 3:return a=e.sent,e.abrupt("return",a.data.response);case 7:e.prev=7,e.t0=e.catch(0),Object(j.a)(m.actions.hasError(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function S(e,t){return C.apply(this,arguments)}function C(){return(C=Object(n.a)(s.a.mark((function e(t,a){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("".concat(f.b,"purchase/save"),{paidStatus:a,_id:t});case 3:return n=e.sent,e.abrupt("return",n.data.response);case 7:e.prev=7,e.t0=e.catch(0),Object(j.a)(m.actions.hasError(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}},2091:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return Y}));var n=a(29),r=a(11),c=a(17),o=a.n(c),s=a(1),i=a(35),u=a(1318),l=a(23),d=a(1429),p=a(28),h=a(59),b=a(424),j=a(1339),f=a(3),m=a(244),x=a(246),v=a(34),O=a(426),g=a(6),y=a(1335),k=a(100),w=a.n(k),S=a(322),C=a(1314),P=a(1334),T=a(1223),I=a(125),L=a(2085),D=a(1306),N=a(1242),E=a(1428),G=a.n(E),q=a(22),B=a(207),_=a(0),A=["UnPaid","Paid","Over Due","Cancelled"],M=[{group:"Payment",classify:["Card","Check","Cash"]}],V=[{group:"Duration",classify:[0,1,2,3]}],Q=Object(g.a)(S.a)((function(e){var t=e.theme;return Object(f.a)(Object(f.a)({},t.typography.subtitle2),{},{color:t.palette.text.secondary,marginBottom:t.spacing(1)})}));function R(e){var t=e.isEdit,a=e.currentProduct,c=Object(i.g)(),u=Object(x.b)().enqueueSnackbar,l=Object(s.useState)([]),h=Object(r.a)(l,2),b=h[0],j=h[1],g=m.b().shape({amount:m.d().required("Amount is required")});console.log(a);var k=Object(s.useMemo)((function(){return{_id:(null===a||void 0===a?void 0:a._id)||"",purchaseId:(null===a||void 0===a?void 0:a.purchaseId)||"",dealer:(null===a||void 0===a?void 0:a.dealer)||"",dateOfPurchase:(null===a||void 0===a?void 0:a.dateOfPurchase)||Date.now(),amount:(null===a||void 0===a?void 0:a.amount)||"",grandTotal:(null===a||void 0===a?void 0:a.grandTotal)||0,vat:(null===a||void 0===a?void 0:a.vat)||10,paidStatus:(null===a||void 0===a?void 0:a.paidStatus)||A[0],due:(null===a||void 0===a?void 0:a.due)||V[0].classify[0],paymentType:(null===a||void 0===a?void 0:a.paymentType)||M[0].classify[0]}}),[a]),E=Object(v.f)({resolver:Object(O.a)(g),defaultValues:k}),R=E.reset,Y=E.watch,W=E.setValue,z=E.getValues,F=E.handleSubmit,J=E.formState.isSubmitting,U=Y();Object(s.useEffect)(Object(n.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.a)();case 2:t=e.sent,console.log(t),j(t.data);case 5:case"end":return e.stop()}}),e)}))),[]),Object(s.useEffect)((function(){t&&a&&R(k),t||R(k)}),[t,a]);var H=function(){var e=Object(n.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("try",U),""===U._id&&delete U._id,0!==U.grandTotal){e.next=6;break}u("Please Enter the amount",{variant:"error"}),e.next=16;break;case 6:return e.prev=6,e.next=9,new Promise((function(e){return setTimeout(e,500)}));case 9:return e.next=11,w.a.post("".concat(q.b,"purchase/save"),U).then((function(e){console.log(e),1===e.data.status?(R(),u(t?"Update success!":"Create success!"),c(p.b.purchase.list)):u("Purchase Id already exist",{variant:"error"})}),(function(e){console.log(e)}));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(){return e.apply(this,arguments)}}();return Object(_.jsx)(B.a,{methods:E,onSubmit:F(H),children:Object(_.jsxs)(C.a,{container:!0,spacing:3,children:[Object(_.jsxs)(C.a,{item:!0,xs:12,md:8,children:[Object(_.jsxs)(P.a,{sx:{p:4},children:[Object(_.jsx)(Q,{children:"Purchase Details"}),Object(_.jsxs)(T.a,{spacing:3,children:[Object(_.jsxs)(I.a,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:[Object(_.jsx)(B.i,{name:"purchaseId",label:"Purchase-Id"}),Object(_.jsx)(B.c,{name:"dateOfPurchase",label:"dateOfPurchase",value:new Date,onChange:function(e){console.log("onChange",e),W(G()(Date.now()).format("DD/MM/YYYY"))}}),Object(_.jsx)(L.a,{freeSolo:!0,options:b,getOptionLabel:function(e){return e.name},style:{width:300},renderInput:function(e){return Object(_.jsx)(D.a,Object(f.a)(Object(f.a)({},e),{},{label:"Company",variant:"outlined"}))},onChange:function(e,t){W("dealer",t)},onInputChange:function(e,t){t&&W("dealer",{_id:null,name:t})}})]}),Object(_.jsx)(Q,{children:"Amount Details"}),Object(_.jsxs)(I.a,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(3, 1fr)"}},children:[Object(_.jsx)(B.i,{name:"amount",label:"Amount",placeholder:"0.00",value:0===z("amount")?"":z("amount"),onChange:function(e){W("amount",Number(e.target.value)),W("grandTotal",Number(Number(e.target.value))+Number(Number(e.target.value)*(z("vat")/100)))},InputLabelProps:{shrink:!0},InputProps:{startAdornment:Object(_.jsx)(N.a,{position:"start",children:"\u20ac"}),type:"number"}}),Object(_.jsx)(B.i,{name:"vat",value:"".concat(z("vat"),"%"),label:"Vat",disabled:!0}),Object(_.jsx)(B.i,{name:"grandTotal",label:"Total",placeholder:"0.00",disabled:!0,value:0===z("grandTotal")?"":z("grandTotal"),onChange:function(e){return W("grandTotal",Number(e.target.value))},InputLabelProps:{shrink:!0},InputProps:{startAdornment:Object(_.jsx)(N.a,{position:"start",children:"\u20ac"}),type:"number"}})]})]})]}),Object(_.jsxs)(P.a,{sx:{p:4,mt:2},children:[Object(_.jsx)(Q,{children:"Purchase Details"}),Object(_.jsx)(T.a,{spacing:3,children:Object(_.jsx)(I.a,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"}},children:Object(_.jsxs)(I.a,{sx:{display:"grid",columnGap:2,rowGap:3,gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(3, 1fr)"}},children:[Object(_.jsx)(B.i,{name:"amount",label:"Amount",placeholder:"0.00",value:0===z("amount")?"":z("amount"),onChange:function(e){W("amount",Number(e.target.value)),W("grandTotal",Number(Number(e.target.value))+Number(Number(e.target.value)*(z("vat")/100)))},InputLabelProps:{shrink:!0},InputProps:{startAdornment:Object(_.jsx)(N.a,{position:"start",children:"\u20ac"}),type:"number"}}),Object(_.jsx)(B.i,{name:"vat",value:"".concat(z("vat"),"%"),label:"Vat"})]})})})]})]}),Object(_.jsx)(C.a,{item:!0,xs:12,md:4,children:Object(_.jsx)(T.a,{spacing:3,children:Object(_.jsx)(P.a,{sx:{p:3},children:Object(_.jsxs)(T.a,{spacing:3,mt:2,children:[Object(_.jsx)(B.g,{name:"due",label:"Duration",children:V.map((function(e){return Object(_.jsx)("optgroup",{label:e.group,children:e.classify.map((function(e){return Object(_.jsxs)("option",{value:e,children:[e," Month"]},e)}))},e.group)}))}),Object(_.jsxs)("div",{children:[Object(_.jsx)(Q,{children:"Status"}),Object(_.jsx)(B.f,{name:"paidStatus",options:A,sx:{"& .MuiFormControlLabel-root":{mr:4}}})]}),Object(_.jsx)(S.a,{variant:"subtitle2",sx:{color:"text.secondary"},children:"Grand Total"}),Object(_.jsxs)(S.a,{variant:"body2",sx:{color:"text.secondary",fontSize:24},children:["\u20ac ",U.grandTotal.toFixed(2)]}),Object(_.jsx)(y.a,{type:"submit",variant:"contained",size:"large",loading:J,children:t?"Save Changes":"Create purchase"})]})})})})]})})}function Y(){var e=Object(h.a)().themeStretch,t=(Object(l.d)(),Object(i.f)().pathname),a=Object(i.h)().name,c=(Object(l.e)((function(e){return e.product})).products,t.includes("edit")),f=Object(s.useState)({}),m=Object(r.a)(f,2),x=m[0],v=m[1];return Object(s.useEffect)(Object(n.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=5;break}return e.next=3,Object(d.c)(a);case 3:t=e.sent,v(t);case 5:case"end":return e.stop()}}),e)}))),[]),Object(_.jsx)(b.a,{title:"Purchase: Create a new product",children:Object(_.jsxs)(u.a,{maxWidth:!e&&"lg",children:[Object(_.jsx)(j.a,{heading:c?"Edit Purchase":"Create a new Purchase",links:[{name:"Dashboard",href:p.b.root},{name:"Purchase",href:p.b.purchase.root},{name:c?"".concat(x.purchaseId):"New "}]}),Object(_.jsx)(R,{isEdit:c,currentProduct:x})]})})}}}]);
//# sourceMappingURL=54.1663a1f8.chunk.js.map